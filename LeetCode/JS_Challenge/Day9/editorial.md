## í•µì‹¬ ì»¨ì…‰ : Extremely important example of a higher-order function - _Memoization_

### Pure Functions

- memoizationì€ ì˜¤ì§ **_pure functions_**ì—ì„œë§Œ ì˜¬ë°”ë¥´ê²Œ ë™ì‘í•œë‹¤.
  - **pure function** : ê°™ì€ inputì´ ë“¤ì–´ì˜¤ë©´ í•­ìƒ ê°™ì€ outputì„ ë¦¬í„´í•˜ë©°, side-effectsë¥¼ ê°€ì§€ì§€ ì•ŠëŠ” í•¨ìˆ˜
  - memoizationê³¼ ê°™ì€ ì„±ëŠ¥ ìµœì í™”ë¥¼ ëˆ„ë¦¬ê¸° ìœ„í•´, ê°€ëŠ¥í•œ í•¨ìˆ˜ë¥¼ pure functionìœ¼ë¡œ ë§Œë“¤ì–´ì•¼ í•œë‹¤.

### Memoization Use-cases in Web Development

- **Caching Website Files**
  ì¼ë°˜ì ìœ¼ë¡œ ëŒ€í˜• ì›¹ì‚¬ì´íŠ¸ëŠ” ë§ì€ JS íŒŒì¼ë¡œ êµ¬ì„±ë˜ë©°, ì‚¬ìš©ìê°€ ì„œë¡œ ë‹¤ë¥¸ í˜ì´ì§€ë¥¼ ë°©ë¬¸í•  ë•Œ ë™ì ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œ ë°›ê²Œ ë¨.
  ì´ëŸ° ìƒí™©ì—ì„œ ë¸Œë¼ìš°ì € ìºì‹±ì´ ì¤‘ìš”í•œ ì—­í• ì„ í•œë‹¤. ğŸŒ§ï¸ `tanstack query`ì™€ ê°™ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ì´ë¥¼ ì´ìš©í•´ì„œ ì„±ëŠ¥ ìµœì í™”ë¥¼ í•œë‹¤.

  ë¸Œë¼ìš°ì € ìºì‹±ì€ ì›¹ ë¸Œë¼ìš°ì €ê°€ ìì£¼ ì‚¬ìš©í•˜ëŠ” íŒŒì¼ì„ ë¡œì»¬ ë””ìŠ¤í¬ì— ì €ì¥í•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤. ì´ë ‡ê²Œ í•˜ë©´, ë™ì¼í•œ íŒŒì¼ì„ ë‹¤ì‹œ ìš”ì²­í•  ë•Œ ì„œë²„ì—ì„œ ë‹¤ì‹œ ë‹¤ìš´ë¡œë“œ ë°›ëŠ” ê²ƒ ë³´ë‹¤ ë¹ ë¥´ê²Œ ë¡œì»¬ ë””ìŠ¤í¬ì—ì„œ ë¡œë“œí•  ìˆ˜ ìˆë”°.

  ë¬¸ì œëŠ” **íŒŒì¼ì˜ ë‚´ìš©ì´ ë³€ê²½ë˜ì—ˆì„ ë•Œ** ë¸Œë¼ìš°ì €ê°€ ì´ë¥¼ ì•Œì•„ì±„ê³  ìƒˆë¡œìš´ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ ë°›ì•„ì•¼ í•œë‹¤ëŠ” ê²ƒì´ë‹¤. ì´ë¥¼ ìœ„í•´ **íŒŒì¼ ì´ë¦„ì„ íŒŒì¼ ë‚´ìš©ì˜ í•´ì‹œë¡œ êµ¬ì„±í•˜ëŠ” íŒ¨í„´**ì„ ì‚¬ìš©í•œë‹¤.
  **í•´ì‹œëŠ” íŒŒì¼ ë‚´ìš©ì— ë”°ë¼ ê³ ìœ í•˜ê²Œ ìƒì„±ë˜ë¯€ë¡œ, íŒŒì¼ ë‚´ìš©ì´ ë³€ê²½ë˜ë©´ í•´ì‹œ ê°’ë„ ë³€ê²½ë˜ê³ , ë”°ë¼ì„œ íŒŒì¼ì´ë¦„ë„ ë³€ê²¨ì˜¤ë”˜ë‹¤.**

  ì˜ˆë¥¼ ë“¤ì–´, íŒŒì¼ `script.js`ê°€ ìˆì„ ë•Œ, ì´ íŒŒì¼ì˜ ë‚´ìš©ì— ëŒ€í•œ í•´ì‹œ ê°’ì´ `123abc`ë¼ë©´ ì´ íŒŒì¼ì˜ ì´ë¦„ì„ `script.123abc.js`ì™€ ê°™ì´ ì‚¬ìš©í•œë‹¤.
  ë§Œì•½ íŒŒì¼ì˜ ì´ë¦„ì´ ë³€ê²½ë˜ë©´ í•´ì‹œ ê°’ë„ `456dfef`ì™€ ê°™ì´ ë³€ê²½ë˜ê³ , íŒŒì¼ì´ë¦„ë„ `script.456def.js`ë¡œ ë³€ê²½ëœë‹¤.

  ì´ëŸ¬í•œ ë°©ë²•ìœ¼ë¡œ cache invalidation ë¬¸ì œ (ì–¸ì œ ìºì‹œëœ íŒŒì¼ì„ ë²„ë¦¬ê³  ìƒˆë¡œìš´ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ ë°›ì•„ì•¼ í• ì§€ë¥¼ ê²°ì •í•˜ëŠ” ë¬¸ì œ)ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í•´ê²°í•  ìˆ˜ ìˆë‹¤.
  í•´ì‹œë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ íŒŒì¼ ë‚´ìš©ì— ë”°ë¼ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.

  ì˜ˆì‹œ)
  ![](https://i.imgur.com/XvhPgS2.png)

  28.ef234422c67d1198.js íŒŒì¼ì—ì„œ ef234422c67d1198 ë¶€ë¶„ì€ íŒŒì¼ì˜ ë‚´ìš©ì„ í•´ì‹œí•œ ê²°ê³¼ì´ë‹¤.

- **React Component**
  `React.memo`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¶ˆí•„ìš”í•œ ë Œë”ë§ì„ ì¤„ì¸ë‹¤.

- **Caching API Calls**
  ë„¤íŠ¸ì›Œí¬ ìš”ì²­ í•¨ìˆ˜ì— `key`ë¥¼ ì‚¬ìš©í•˜ì—¬, `key`ì— í•´ë‹¹í•˜ëŠ” ê°’ì„ ìºì‹±í•˜ë„ë¡ í•˜ì—¬ ì„±ëŠ¥ì„ ë†’í ìˆ˜ ìˆë‹¤.
  ê·¸ëŸ¬ë‚˜, ì´ ê²½ìš° `data staleness`ì— ê´€í•œ ë¬¸ì œê°€ ìƒê¸°ê³  ì´ì— ëŒ€í•œ í•´ê²°ë°©ì•ˆì„ ë§ˆë ¨í•´ì•¼ í•œë‹¤.

  - a few ways to handle this
    1. í•­ìƒ ê°’ì´ ë³€ê²½ë˜ì—ˆëŠ”ì§€ ë¬»ëŠ” ìš”ì²­ì„ APIì— ë³´ë‚¸ë‹¤. (ğŸŒ§ï¸ `E-tag`ë‚˜ `Last-Modified` í—¤ë”ë¥¼ ì´ìš©í•œ ì¡°ê±´ë¶€ ìš”ì²­ì„ ëœ»í•˜ëŠ” ë“¯)
    2. Websocketì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì˜ ê°’ ë³€ê²½ì„ êµ¬ë…í•œë‹¤.
    3. ë§Œë£Œ ì‹œê°„ ê°’ì„ ì§€ì •í•œë‹¤.

## Note

### TypeScriptì˜ ì œë„¤ë¦­ì„ í™œìš©í•œ ì½”ë“œ ì‘ì„±í•˜ê¸°

```typescript
type Fn = (...params: any[]) => any;

function memoize<T extends Fn>(fn: T): T {
  const map = new Map<string, ReturnType<T>>();

  return ((...args: Parameters<T>): ReturnType<T> => {
    const key = JSON.stringify(args);

    if (map.has(key)) {
      return map.get(key) as ReturnType<T>;
    }

    const result = fn(...args);
    map.set(key, result);
    return result;
  }) as T;
}
```

- `<T extends Fn>`ì€ TypeScriptì˜ ì œë„¤ë¦­ íƒ€ì…ì„ ì •ì˜í•˜ëŠ” ë¬¸ë²•ì´ë‹¤. ì´ëŠ” `T`ë¼ëŠ” íƒ€ì… ë³€ìˆ˜ë¥¼ ì„ ì–¸í•˜ë©°, ì´ `T`ëŠ” `Fn` íƒ€ì… ë˜ëŠ” ê·¸ ì„œë¸Œ íƒ€ì…ì„ ê°€ì§ˆ ìˆ˜ ìˆë‹¤.
- `Fn`ì€ `(...params: any[]) => any`ë¼ëŠ” í•¨ìˆ˜ íƒ€ì…ì„ ë‚˜íƒ€ë‚´ëŠë‹¤. ë”°ë¼ì„œ `<T extends Fn>`ì€ `T`ê°€ ì´ì™€ ê°™ì€ í•¨ìˆ˜ íƒ€ì…, ì¦‰ ì–´ë–¤ ìˆ˜ì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ë°›ê³  ì–´ë–¤ íƒ€ì…ì˜ ê°’ì„ ë³€í™˜í•  ìˆ˜ ìˆëŠ” í•¨ìˆ˜ íƒ€ì…ì´ì–´ì•¼ í•¨ì„ ì˜ë¯¸í•œë‹¤.
- `memoize` í•¨ìˆ˜ì˜ ë°˜í™˜íƒ€ì…ë„ `T`ë¡œ ì§€ì •ë˜ì–´ ìˆëŠ”ë°, ì´ëŠ” `memoize` í•¨ìˆ˜ê°€ ì…ë ¥ìœ¼ë¡œ ë°›ì€ í•¨ìˆ˜ì™€ ë™ì¼í•œ íƒ€ì…ì˜ í•¨ìˆ˜ë¥¼ ë°˜í™˜í•¨ì„ ì˜ë¯¸í•œë‹¤. (ì–´ë–¤ í•¨ìˆ˜ë¥´ `memoize` í•¨ìˆ˜ì— ë„£ë”ë¼ë„ ê·¸ í•¨ìˆ˜ì˜ íƒ€ì…ì´ ë³´ì¡´ëœë‹¤.) â–¶ï¸ ì•„ë£° í†µí•´ íƒ€ì… ì•ˆì „ì„±ì„ ë”ìš± í™•ë³´í•  ìˆ˜ ìˆë‹¤.
- ì œë„¤ë¦­ì„ ì‚¬ìš©í•˜ë©´ `memoize` í•¨ìˆ˜ê°€ ì…ë ¥ í•¨ìˆ˜ì˜ ì •í™•í•œ íƒ€ì…ì„ ì¶”ì í•˜ê³  ê·¸ íƒ€ì…ì„ ê·¸ëŒ€ë¡œ ë³´ì¡´í•  ìˆ˜ ìˆë”°.

### `JSON.stringify`ë¥¼ ì‚¬ìš©í•  ë•Œ ì£¼ì˜ì 

- ìˆœí™˜ ì°¸ì¡°ë¥¼ ê°€ì§„ ê°ì²´ë‚˜ í•¨ìˆ˜ ë“±ì€ ë¬¸ìì—´í™”í•  ìˆ˜ ì—†ìœ¼ë©°, í”„ë¡œí¼í‹° ìˆœì„œì— ë”°ë¼ ê°™ì€ ê°ì²´ë„ ë‹¤ë¥¸ ë¬¸ìì—´ë¡œ ë³€í™˜ë  ìˆ˜ë„ ìˆë‹¤.
- ë³µì¡í•œ ìƒí™©ì— ëŒ€í•œ ì²˜ë¦¬ê°€ í•„ìš”í•˜ë©´ keyì— ëŒ€í•œ **ë³„ë„ì˜ í•´ì‹œ í•¨ìˆ˜**ë¥¼ ì´ìš©í•œë‹¤.

> Concerns of Professional Implementation
>
> 1. Handling Arbitrary Inputs : í•¨ìˆ˜ì˜ ì…ë ¥ì— ë”°ë¼ì„œ ë¬¸ìì—´ë¡œ ì§ì ‘ ë³€í™˜í•˜ëŠ” ê²ƒ ë³´ë‹¤ ë³µì¡í•œ ì ‘ê·¼ ë°©ì‹ì´ í•„ìš”í•  ìˆ˜ë„ ìˆë‹¤.
> 2. Memory Management : ë‹¤ë¥¸ ì…ë ¥ê°’ìœ¼ë¡œ í•¨ìˆ˜ë¥´ ë¬´í•œì • í˜¸ì¶œí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë©”ëª¨ë¦¬ê°€ ë³µì¡í•´ì§ˆ ìˆ˜ë„ ìˆë‹¤. ë”°ë¼ì„œ, ìºì‹œ í¬ê¸°ë¥¼ ì œí•œí•˜ëŠ” ë§¤ì»¤ë‹ˆì¦˜ì´ í•„ìš”í•˜ë‹¤.
>    ì´ëŸ¬í•œ ì ‘ê·¼ ë°©ì‹ìœ¼ë¡œ **Least Recently Used** Cacheë¥¼ ìƒê°í•  ìˆ˜ë„ ìˆë‹¤.
>
> [ì´ëŸ¬í•œ ë‚´ìš©ë“¤ì€ Memoize II ì—ì„œ í™•ì¸í•œë‹¤!](https://leetcode.com/problems/memoize-ii/description/)
